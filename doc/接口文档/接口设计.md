# 前后端接口设计说明书

## User 用户

### 获取某用户资料

* Url: `/api/user_profile/`
* Method: `GET`
* Params: `username: 2017110048`
* Return: `json`

```json
{
    "code": "101",
    "msg": "success",
    "result": {
        "username": "2017110048",
        "nickname": "zjb",
    }
}
```

### 获取个人全部资料

* Url: `/api/myself/`
* Method: `GET`
* Params: `token: abcdefg`
* Return: `json`

```json
{
    "code": "102",
    "msg": "success",
    "result": {
        "username": "2017110048",
        "nickname": "zjb",
        "max_size": 123123123,
        "used_size": 123123,
    }
}
```

### 修改个人资料

* Url: `/api/myself/`
* Method: `PUT`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "nickname": "zhangjunbo"
}
```

* Return: `json`

```json
{
    "code": "103",
    "msg": "success",
    "result": {}
}
```

### **登入**

?

## Group 群组

### 获取个人全部群组

* Url: `/api/my_group/`
* Method: `GET`
* Params: `token: abcdefg`
* Return: `json`

```json
{
    "code": "201",
    "msg": "success",
    "result":[
        {
            "id": 3,
            "name": "重案六组",
            "member_number": 60,
        },{
            "id": 12,
            "name": "日语资料分享群",
            "member_number": 122,
        }
    ]
}
```

### 获取某群组详细信息

* Url: `/api/my_group/`
* Method: `GET`
* Params: `token: abcdefg & id: 12`
* Return: `json`

```json
{
    "code": "202",
    "msg": "success",
    "result": {
        "id": 12,
        "name": "日语资料分享群",
        "member_number": 122,
        "members": [
            {
                "username": "2017110048",
                "nickname": "zjb",
                "permission": "member"
            },{
                "username": "9017123456",
                "nickname": "老司机",
                "permission": "master"
            }
        ]
    }
}
```

### 修改某群组信息

* Url: `/api/group_info/`
* Method: `PUT`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "id": 12,
    "name": "正经学习群",
}
```

* Return: `json`

```json
{
    "code": "203",
    "msg": "success",
    "result": {}
}
```

### 建立一个新群组

* Url: `/api/my_group`
* Method: `POST`
* Params: `token: abcdefg`

* Return: `json`

```json
{
    "code": "204",
    "msg": "success",
    "result": {
        "id": 36,
        "name": "zjb的小组"
    }
}
```

### 解散一个群组

* Url: `/api/my_group`
* Method: `DELETE`
* Params: `tokem: abcdefg`
* Body: `json`

```json
{
    "id": 36
}
```

* Return: `json`

```json
{
    "code": "205",
    "msg": "success",
    "result": {}
}
```

### 踢掉一个成员

* Url: `api/membership`
* Method: `DELETE`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "id": 36,
    "username": "9012123456"
}
```

* Return: `json`

```json
{
    "code": "206",
    "msg": "success",
    "result": {}
}
```

### 请求加入一个群

* Url: `api/intention/`
* Method: `POST`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "id": 36 //群组id
}
```

* Return: `json`

```json
{
    "code": "207",
    "msg": "success",
    "result": {}
}
```

### 查看某群的请求加入列表

* Url: `api/intention/`
* Method: `GET`
* Params: `token: abcdefg & id: 36`
* Return: `json`

```json
{
    "code": "208",
    "msg": "success",
    "result": [
        {
            "username": "2017110048",
            "nickname": "zjb",
            "date_intented": "2017-12-12 08:12:12" //申请时间
        },{
            "username": "9012110048",
            "nickname": "richzjb",
            "date_intented": "2017-12-12 08:12:12"
        }
    ]
}
```

### 同意某人的加入申请

* Url: `api/intention/`
* Method: `POST`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "id": 36, //群组id
    "username": "2017110048"
}
```

* Return: `json`

```json
{
    "code": "209",
    "msg": "success",
    "result": {}
}
```

### 拒绝某人的加入申请

* Url: `api/intention/`
* Method: `DELETE`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "id": 36, //群组id
    "username": "2017110048"
}
```

* Return: `json`

```json
{
    "code": "210",
    "msg": "success",
    "result": {}
}
```

## Storage 存储仓库

### 获取个人仓库根目录

* Url: `/api/my_storage/`
* Method: `GET`
* Params: `token: abcdefg`
* Return: `json`

```json
{
    "code": "301",
    "status": "success",
    "result":[
        {
            "id": 71,
            "name": "日语学习资料",
            "is_file": false,
            "is_shared": false,
            "modified_date": "2019-11-24"
        },{
            "id": 103,
            "name": "那个自由♂男人",
            "is_file": true,
            "size": 10241024,
            "extension": "avi",
            "is_shared": false,
            "modified_date": "2019-11-24"
        }
    ]
}
```

### 获取个人仓库某文件夹内容

* Url: `/api/my_storage/`
* Method: `GET`
* Params: `token: abcdefg & id: 71`
* Return: `json`

```json
{
    "code": "302",
    "status": "success",
    "result":[
        {
            "id": 109,
            "name": "すごい AV机器",
            "is_file": true,
            "size": 101234,
            "extension": "mp4",
            "is_shared": false,
            "modified_date": "2019-11-24"
        },{
            "id": 110,
            "name": "やばい! おフェロ女子",
            "is_file": true,
            "size": 1021443,
            "extension": "flv",
            "is_shared": false,
            "modified_date": "2019-11-24"
        },{
            "id": 78,
            "name": "最新写真集",
            "is_file": false,
            "is_shared": false,
            "modified_date": "2019-11-24"
        }
    ]
}
```

### 删除个人仓库某文件(夹)

* Url: `/api/my_storage/`
* Method: `DELETE`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "id": 71
}
```

* Return: `json`

```json
{
    "code": "303",
    "status": "success",
    "result":{}
}
```

### 修改个人仓库某文件(夹)

* Url: `/api/my_storage`
* Method: `PUT`
* * Params: `token: abcdefg`
* Body: `json`

```json
{
    "id": 71,
    "name": "青年大学习资料",
    //如果是文件要有下面的接口
    "extension": "txt",
}
```

* Return: `json`

```json
{
    "code": "304",
    "status": "success",
    "result":{}
}
```

### 新建文件夹

* Url: `/api/my_storage`
* Method: `POST`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "id": 71, //所在文件夹id，根目录不添加该接口
}
```

* Return: `json`

```json
{
    "code": "305",
    "status": "success",
    "result":{
        "id": 74,
        "name": "新建文件夹"
    }
}
```

### **上传文件**

？

### 获取某群组仓库根目录

* Url: `/api/group_storage/`
* Method: `GET`
* Params: `token: abcdefg & group_id: 3`
* Return: `json`

```json
{
    "code": "307",
    "status": "success",
    "result":[
        {
            "id": 98,
            "name": "省下发文件",
            "is_file": false,
            "is_shared": false,
            "modified_date": "2019-11-24"
        },{
            "id": 103,
            "name": "扫黄打飞注意事项",
            "is_file": true,
            "size": 3150,
            "extension": "doc",
            "is_shared": false,
            "modified_date": "2019-11-24"
        }
    ]
}
```

### 获取某群组仓库某文件夹内容

* Url: `/api/group_storage/`
* Method: `GET`
* Params: `token: abcdefg & group_id: 3 & catalogue_id: 98`
* Return: `json`

```json
{
    "code": "308",
    "status": "success",
    "result":[
        {
            "id": 219,
            "name": "钓鱼执法的必要性",
            "is_file": true,
            "size": 51234,
            "extension": "doc",
            "is_shared": false,
            "modified_date": "2019-11-24"
        },{
            "id": 220,
            "name": "《人民的名义》电视连续剧",
            "is_file": false,
            "is_shared": false,
            "modified_date": "2019-11-24"
        }
    ]
}
```

### 删除某群组仓库某文件(夹)

* Url: `/api/group_storage/`
* Method: `DELETE`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "group_id": 3,
    "catalogue_id": 98
}
```

* Return: `json`

```json
{
    "code": "309",
    "status": "success",
    "result":{}
}
```

### 修改某群组仓库某文件(夹)

* Url: `/api/group_storage`
* Method: `PUT`
* * Params: `token: abcdefg`
* Body: `json`

```json
{
    "group_id": 3,
    "catalogue_id": 98,
    "name": "青年大学习资料",
    //如果是文件要有下面的接口
    "extension": "txt",
}
```

* Return: `json`

```json
{
    "code": "310",
    "status": "success",
    "result":{}
}
```

### 在群组仓库新建文件夹

* Url: `/api/group_storage`
* Method: `POST`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "group_id": 3,
    "catalogue_id": 98 //所在文件夹id，根目录不添加该接口
}
```

* Return: `json`

```json
{
    "code": "311",
    "status": "success",
    "result":{
        "id": 100,
        "name": "新建文件夹"
    }
}
```

## Share 分享

### 创建分享链接

* Url: `/api/share/`
* Method: `POST`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "id": 109,
    "delta_time": "0-30-0 00:00:00",
}
```

* Return: `json`

```json
{
    "code": "401",
    "msg": "success",
    "result":{
        "url": "xbabasdasd",
        "pwd": "1234",
        "expiration": "2020-3-2 19:00:00",
    }
}
```

### 分享到群组

* Url: `/api/share_to_group`
* Method: `POST`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "group_id": 3,
    "url": "xbabasdasd",
    "catalogue_id": 99,
}
```

* Return: `json`

```json
{
    "code": "402",
    "msg": "success",
    "result": {}
}
```

### 保存别人的分享到个人仓库

* Url: `/api/share_to_me`
* Method: `PUT`
* Params: `token: abcdefg`
* Body: `json`

```json
{
    "url": "xbabasdasd",
    "id": 233, //个人仓库目录id
}
```

* Return: `json`

```json
{
    "code": "403",
    "msg": "success",
    "result": {}
}
```
